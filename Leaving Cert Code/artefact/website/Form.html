<!DOCTYPE html>
    <html>
        <head>
           <title>Home</title>
           <link rel = "stylesheet" type="text/css" href = "style2.css">

        </head>
       

        <body>
            <div class="header-bar">
                <a href = "scatter.html">3D Scatter Graph</a>
                -----------
                <a href = "home.html">Home</a>
                -----------
                <a href = "Form.html">User Form </a>
            </div>

            <div class="box">
            Please complete this form! <br>
            Name
            <input type= "text" placeholder="Name" id = "namein">
            Have you played Terraria? (y/n)
            <input type="text" placeholder="y/n" id="boolin">
            Age
            <input type="text" placeholder = "Age" id="agein">

            <button onclick="getdata()">Click here to add your data!</button>
            
            </div>
            
            <div class = "box3" id = "allRecords"><b><u>RECORDS</u></b></div>

            <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-analytics.js";
            import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";
            import { onChildAdded } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";


            // Your web app's Firebase configuration
            const firebaseConfig = {
                apiKey: "AIzaSyDbi6wILwD0VAnI8FRjXWV6tg3ngjpv6fg",
                authDomain: "leaving-cert-project-76b59.firebaseapp.com",
                databaseURL: "https://leaving-cert-project-76b59-default-rtdb.europe-west1.firebasedatabase.app",
                projectId: "leaving-cert-project-76b59",
                storageBucket: "leaving-cert-project-76b59.firebasestorage.app",
                messagingSenderId: "226956322836",
                appId: "1:226956322836:web:30ddf99ceff006e38c1f01",
                measurementId: "G-PNT0FYQXE7"
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const database = getDatabase(app);


            
                window.getdata = function() {
                    if ((document.getElementById("boolin").value).toLowerCase() == 'y') {
                        var bools = true
                    }
                    else if ((document.getElementById("boolin").value).toLowerCase() == 'n') {
                        var bools = false
                    }
                    else {
                        alert("Invalid response for 'Have you played Terraria?' please input y or n")
                    }
                    
                    if (isNaN((document.getElementById("agein").value)) == true) {
                        alert("Invalid age input")
                    }

                    var jsname=document.getElementById("namein").value;
                    var jsage= Number(document.getElementById("agein").value);
                    var jsbool= bools;

                    const myDataloc = ref(database, 'Userinfo');
                    const mydata = push(myDataloc);
                    
                    set(mydata, {
                        Name: jsname,
                        Age: jsage,
                        PlayedTerraria: jsbool
                    }
                
                    );
             }
              
             const myDatabase = ref(database, 'Userinfo');
             onChildAdded(myDatabase, (snapshot) => {
                const data = snapshot.val();
                const key = snapshot.key;
                displayrecords(data,key)
             })

             function displayrecords(data,key){
                document.getElementById("allRecords").innerHTML += `
                    <div>
                        <strong>Name:</strong> ${data.Name} <br>
                        <strong>Age:</strong> ${data.Age} <br>
                        <strong>Played Terraria:</strong> ${data.PlayedTerraria} <br><br>
                    </div>`;
             }
              </script>
        </body>
    </html>
    